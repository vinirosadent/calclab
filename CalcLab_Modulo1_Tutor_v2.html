<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>CalcLab • Módulo 1 — Álgebra & Funções (Tutor v2)</title>
<meta name="description" content="Curso interativo do zero ao cálculo. Módulo 1 cobre Álgebra aplicada e Funções, com explicações, exercícios, dicas e soluções. Visual melhorado com fórmulas renderizadas.">
<!-- MathJax for beautiful math -->
<script id="MathJax-script" async
  src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js">
</script>
<style>
  :root {
    --bg:#f6f7fb; --panel:#fff; --ink:#0b1220; --muted:#475569; --border:#e5e7eb; --accent:#4f46e5;
    --ok:#065f46; --bad:#9f1239; --warn:#854d0e;
  }
  *{box-sizing:border-box}
  body{margin:0;font-family:Inter, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial;
       color:var(--ink); background:linear-gradient(180deg,#f8fafc, #eef2ff)}
  header{position:sticky;top:0;background:#ffffffcc;backdrop-filter:blur(8px);
         border-bottom:1px solid var(--border)}
  .wrap{max-width:1200px;margin:0 auto;padding:12px 16px;display:flex;gap:12px;align-items:center}
  h1{font-size:20px;margin:0;letter-spacing:0.2px}
  .tag{font-size:12px;background:#e0e7ff;color:#3730a3;border-radius:999px;padding:4px 10px}
  main{max-width:1200px;margin:0 auto;padding:20px 16px 40px;display:grid;grid-template-columns:320px 1fr;gap:20px}
  .card{background:var(--panel);border:1px solid var(--border);border-radius:18px;box-shadow:0 8px 20px rgba(0,0,0,.04)}
  .sidebar{padding:16px}
  .sidebar h2{margin:0 0 8px;font-size:16px}
  .nav li{display:flex;justify-content:space-between;align-items:center;padding:10px 0;border-bottom:1px dashed var(--border);font-size:14px}
  .nav li:last-child{border-bottom:none}
  .pill{font-size:12px;border-radius:999px;padding:3px 8px}
  .done{background:#d1fae5;color:var(--ok)} .todo{background:#e2e8f0;color:#334155}
  .content{display:grid;gap:18px}
  .section{padding:18px}
  .section h3{margin:0 0 10px;font-size:20px}
  .row{display:grid;grid-template-columns:1fr 1fr;gap:16px}
  .panel{background:#f8fafc;border:1px solid var(--border);border-radius:14px;padding:12px}
  .muted{color:var(--muted)} .ok{color:var(--ok)} .bad{color:var(--bad)} .warn{color:var(--warn)}
  .btn{border:1px solid var(--border);background:white;color:#0b1220;border-radius:10px;padding:8px 12px;cursor:pointer;box-shadow:0 1px 2px rgba(0,0,0,.03)}
  .btn.primary{background:var(--accent);border-color:var(--accent);color:white}
  .btn.flat{background:#eef2ff;border-color:#c7d2fe}
  .btn:disabled{opacity:.6;cursor:not-allowed}
  .grid-2{display:grid;grid-template-columns:1fr 1fr;gap:10px}
  .grid-3{display:grid;grid-template-columns:1fr 1fr 1fr;gap:10px}
  .kv{display:flex;justify-content:space-between;font-size:14px;margin:6px 0;color:var(--muted)}
  input[type="number"], input[type="text"]{width:100%;padding:10px;border:1px solid var(--border);border-radius:10px;font-size:14px}
  input[type="range"], select, textarea{width:100%}
  textarea{min-height:96px}
  canvas{width:100%;height:320px;border-radius:12px;background:white;border:1px solid var(--border)}
  details{border:1px dashed var(--border);padding:10px;border-radius:10px;background:#ffffff}
  summary{cursor:pointer}
  hr{border:none;border-top:1px dashed var(--border);margin:16px 0}
  .tutor{position:sticky; top:80px; display:flex; gap:10px; align-items:flex-start; background:#fff; border:1px solid var(--border); border-radius:12px; padding:10px}
  .tutor .avatar{width:36px;height:36px;border-radius:50%;background:#e0e7ff;display:flex;align-items:center;justify-content:center;font-weight:700;color:#3730a3}
  .tutor .msg{font-size:14px; color:#0f172a}
  .tip{font-size:12px;color:#334155;background:#f8fafc;border:1px solid var(--border);padding:6px 8px;border-radius:8px}
  .badge{font-size:11px;border-radius:6px;padding:2px 6px;background:#ecfeff;color:#0369a1;border:1px solid #bae6fd}
  .formula{font-size:18px; background:#ffffff; border:1px solid var(--border); padding:8px 12px; border-radius:10px; display:inline-block}
  .callout{background:#fff7ed;border:1px solid #fed7aa;color:#7c2d12;padding:8px 10px;border-radius:10px;font-size:13px}
  @media (max-width: 980px){ main{grid-template-columns:1fr} .row{grid-template-columns:1fr} .tutor{position:relative; top:0} }
</style>
</head>
<body>
  <header>
    <div class="wrap">
      <h1>CalcLab • Do Zero ao Cálculo</h1>
      <div class="tag">Módulo 1 — Álgebra & Funções (tutor v2)</div>
    </div>
  </header>

  <main>
    <aside class="sidebar card">
      <h2>Sua trilha</h2>
      <ul class="nav">
        <li><span>1. Álgebra aplicada</span><span id="p-a1" class="pill todo">Pendente</span></li>
        <li><span>2. Funções: visão geral</span><span id="p-a2" class="pill todo">Pendente</span></li>
        <li><span>3. Transformações de gráficos</span><span id="p-a3" class="pill todo">Pendente</span></li>
        <li><span>4. Exercícios guiados</span><span id="p-a4" class="pill todo">Pendente</span></li>
        <li><span>5. Mini-prova</span><span id="p-a5" class="pill todo">Pendente</span></li>
      </ul>
      <div class="tutor">
        <div class="avatar">T</div>
        <div class="msg">
          <b>Seu Tutor</b><br>
          “Agora com fórmulas <u>renderizadas</u> pelo MathJax. Se algo aparecer com ^, atualize a página e aguarde 1–2s para renderizar.”
        </div>
      </div>
      <p class="muted" style="margin-top:8px">Progresso salvo automaticamente no navegador.</p>
    </aside>

    <section class="content">

      <!-- 1. ALGEBRA APLICADA -->
      <div class="card section">
        <h3>1) Álgebra aplicada — o que é e por que importa</h3>
        <div class="row">
          <div class="panel">
            <p><b>Álgebra</b> é a linguagem simbólica para descrever relações entre quantidades. Você manipula variáveis e expressões para <i>generalizar</i> padrões e resolver problemas.</p>
            <p>Exemplos imediatos:</p>
            <ul>
              <li><b>Crescimento</b>: \\(A(t)=A_0\\,e^{kt}\\) ou \\(A(t)=A_0(1+i)^t\\).</li>
              <li><b>Física</b>: \\(s(t)=s_0+v_0 t + \\tfrac{1}{2}at^2\\).</li>
              <li><b>Epidemias</b> (modelo simples): \\(R_t\\) e taxas de variação.</li>
            </ul>
            <details><summary>Produtos notáveis e fatoração (referência rápida)</summary>
              <div class="formula">\\((a+b)^2=a^2+2ab+b^2\\)</div>
              <div class="formula">\\((a-b)^2=a^2-2ab+b^2\\)</div>
              <div class="formula">\\(a^2-b^2=(a-b)(a+b)\\)</div>
              <div class="formula">\\(ax+ay=a(x+y)\\)</div>
            </details>
          </div>
          <div>
            <div class="panel">
              <h4>Aquecimento — simplifique</h4>
              <p>Assuma \\(x\\ne\\pm 3\\). Simplifique:</p>
              <div class="formula">\\( \\dfrac{x^2-9}{x^2-6x+9} \\)</div>
              <div class="grid-2" style="margin-top:8px">
                <input id="warm1" type="text" placeholder="Responda: (x+3)/(x-3)">
                <div class="grid-3">
                  <button class="btn" onclick="hintWarm()">Dica</button>
                  <button class="btn primary" onclick="checkWarm()">Verificar</button>
                  <button class="btn" onclick="revealWarm()">Ver solução</button>
                </div>
              </div>
              <div id="warm-msg" class="kv"></div>
              <details id="warm-sol" style="display:none;margin-top:8px"><summary>Solução completa</summary>
                <div>Fatorize: \\(x^2-9=(x-3)(x+3)\\) e \\(x^2-6x+9=(x-3)^2\\). Cancela \\((x-3)\\) (com \\(x\\ne 3\\)) e fica \\(\\dfrac{x+3}{x-3}\\).</div>
              </details>
            </div>
            <div style="margin-top:12px">
              <button class="btn flat" onclick="markDone('a1')">Marcar seção concluída</button>
            </div>
          </div>
        </div>
      </div>

      <!-- 2. FUNÇÕES OVERVIEW -->
      <div class="card section">
        <h3>2) Funções — visão geral e classificação</h3>
        <div class="row">
          <div class="panel">
            <p>Uma função associa a cada entrada \\(x\\) exatamente uma saída \\(y=f(x)\\). Tipos comuns:</p>
            <ul>
              <li><b>Linear</b>: \\(f(x)=ax+b\\)</li>
              <li><b>Quadrática</b>: \\(f(x)=ax^2+bx+c\\)</li>
              <li><b>Racional</b>: \\(f(x)=\\dfrac{p(x)}{q(x)}\\)</li>
              <li><b>Exponencial</b>: \\(f(x)=A\\,e^{kx}\\)</li>
              <li><b>Logarítmica</b>: \\(f(x)=\\log_b x\\)</li>
            </ul>
            <div class="callout">Dica: identificar o <b>formato</b> é meio caminho para saber como a função cresce ou varia.</div>
          </div>
          <div>
            <div class="panel">
              <h4>Classifique a expressão</h4>
              <div id="cls-render" class="formula">\\(2x+5\\)</div>
              <div class="grid-2" style="margin-top:8px">
                <select id="cls-fn">
                  <option value="">Escolha o tipo</option>
                  <option>Linear</option><option>Quadrática</option><option>Racional</option><option>Exponencial</option><option>Logarítmica</option>
                </select>
                <div class="grid-2">
                  <button class="btn" onclick="hintClass()">Dica</button>
                  <button class="btn primary" onclick="checkClass()">Verificar</button>
                </div>
              </div>
              <div class="grid-2" style="margin-top:8px">
                <button class="btn" onclick="newClass()">Novo exemplo</button>
                <span id="cls-msg" class="kv"></span>
              </div>
            </div>
            <div style="margin-top:12px">
              <button class="btn flat" onclick="markDone('a2')">Marcar seção concluída</button>
            </div>
          </div>
        </div>
      </div>

      <!-- 3. TRANSFORMAÇÕES DE GRÁFICOS -->
      <div class="card section">
        <h3>3) Transformações de gráficos</h3>
        <p>Veja como \\(y=f(x)\\) muda com <span class="badge">translações</span>, <span class="badge">escala</span> e <span class="badge">reflexões</span>.</p>
        <div class="row">
          <div class="panel">
            <h4>Base: \\(f(x)=x^2\\)</h4>
            <canvas id="plot-tr"></canvas>
          </div>
          <div>
            <div class="grid-2">
              <label>Translação horizontal (h) <input id="tr-h" type="range" min="-4" max="4" value="0" step="0.1"></label>
              <label>Translação vertical (k) <input id="tr-k" type="range" min="-5" max="5" value="0" step="0.1"></label>
              <label>Escala vertical (a) <input id="tr-a" type="range" min="-3" max="3" value="1" step="0.1"></label>
            </div>
            <div id="tr-info" class="kv"></div>
            <details style="margin-top:8px"><summary>Resumo</summary>
              <ul>
                <li>\\(y=f(x-h)\\) move o gráfico para a direita em \\(h\\).</li>
                <li>\\(y=f(x)+k\\) sobe/abaixa \\(k\\).</li>
                <li>\\(y=a\\, f(x)\\) estica/achata; se \\(a&lt;0\\), reflete.</li>
              </ul>
            </details>
            <div style="margin-top:12px">
              <button class="btn flat" onclick="markDone('a3')">Marcar seção concluída</button>
            </div>
          </div>
        </div>
      </div>

      <!-- 4. EXERCÍCIOS GUIADOS -->
      <div class="card section">
        <h3>4) Exercícios guiados (com dicas graduais)</h3>
        <div class="row">
          <div class="panel">
            <h4>4.1 Resolver equação racional</h4>
            <p>Resolva para \\(x\\): \\( \\dfrac{2x+3}{x-1} = 5 \\)</p>
            <div class="grid-2">
              <input id="ex1" type="number" placeholder="x = ?">
              <div class="grid-3">
                <button class="btn" onclick="hintEx1()">Dica</button>
                <button class="btn primary" onclick="checkEx1()">Verificar</button>
                <button class="btn" onclick="solEx1()">Ver solução</button>
              </div>
            </div>
            <div id="ex1-msg" class="kv"></div>
            <details id="ex1-sol" style="display:none;margin-top:8px"><summary>Solução</summary>
              <div>Multiplique por \\(x-1\\): \\(2x+3=5(x-1)\\) ⇒ \\(2x+3=5x-5\\) ⇒ \\(-3x=-8\\) ⇒ \\(x=\\tfrac{8}{3}\\). Domínio: \\(x\\ne 1\\).</div>
            </details>
          </div>
          <div class="panel">
            <h4>4.2 Identificar parâmetros em exponencial</h4>
            <p>Dada \\(g(x)=A\\,e^{kx}+C\\), com \\(g(0)=7\\) e \\(g(1)=e^2+3\\).</p>
            <div class="grid-3">
              <label>A = <input id="ex2A" type="number" step="0.01"></label>
              <label>k = <input id="ex2k" type="number" step="0.01"></label>
              <label>C = <input id="ex2C" type="number" step="0.01"></label>
            </div>
            <div class="grid-3" style="margin-top:8px">
              <button class="btn" onclick="hintEx2()">Dica</button>
              <button class="btn primary" onclick="checkEx2()">Verificar</button>
              <button class="btn" onclick="solEx2()">Ver solução</button>
            </div>
            <div id="ex2-msg" class="kv"></div>
            <details id="ex2-sol" style="display:none;margin-top:8px"><summary>Solução</summary>
              <div>\\(g(0)=A+C=7\\) e \\(g(1)=Ae^{k}+C=e^2+3\\). Subtraindo: \\(A(e^{k}-1)=e^2-4\\).
              Uma solução simples: \\(C=3\\) ⇒ \\(A=4\\) ⇒ \\(4(e^{k}-1)=e^2-4\\) ⇒ \\(e^{k}=e^2/4\\) ⇒ \\(k=2-\\ln 4\\).</div>
            </details>
          </div>
        </div>
      </div>

      <!-- 5. MINI-PROVA -->
      <div class="card section">
        <h3>5) Mini-prova (auto-correção + soluções)</h3>
        <div id="quiz" class="panel"></div>
        <div class="grid-2" style="margin-top:8px">
          <button class="btn" onclick="newQuiz()">Gerar questões</button>
          <button class="btn primary" onclick="checkQuiz()">Corrigir</button>
        </div>
        <div id="quiz-msg" class="kv"></div>
        <div style="margin-top:12px"><button class="btn flat" onclick="markDone('a5')">Marcar seção concluída</button></div>
      </div>

    </section>
  </main>

<script>
// ======= Utils & Progress =======
const $ = (s)=>document.querySelector(s);
function save(k,v){ localStorage.setItem(k, JSON.stringify(v)); }
function load(k,d){ try{ const v = JSON.parse(localStorage.getItem(k)); return v ?? d; }catch{ return d; } }
function randint(a,b){ return Math.floor(Math.random()*(b-a+1))+a; }

const prog = load('clab-m1-tutor-v2',{a1:false,a2:false,a3:false,a4:false,a5:false});
function updatePills(){
  for(const k of ['a1','a2','a3','a4','a5']){
    const pill = $('#p-'+k);
    const done = !!prog[k];
    pill.className = 'pill '+(done?'done':'todo');
    pill.textContent = done?'Concluído':'Pendente';
  }
}
function markDone(k){ prog[k]=true; save('clab-m1-tutor-v2',prog); updatePills(); }
updatePills();

// ======== Warm-up ========
let warmHints = 0;
function hintWarm(){
  warmHints++;
  const out = $('#warm-msg');
  if(warmHints===1) out.innerHTML = '<span class="warn">Dica 1: fatorize numerador e denominador.</span>';
  else if(warmHints===2) out.innerHTML = '<span class="warn">Dica 2: x^2−9=(x−3)(x+3) e x^2−6x+9=(x−3)^2.</span>';
  else out.innerHTML = '<span class="warn">Agora cancele fatores comuns (x≠±3).</span>';
}
function checkWarm(){
  const v = ($('#warm1').value||'').replace(/\s+/g,'');
  if(v.toLowerCase() === '(x+3)/(x-3)'){
    $('#warm-msg').innerHTML = '<span class="ok">Perfeito! ✔</span>'; $('#warm-sol').style.display='none';
  } else {
    $('#warm-msg').innerHTML = '<span class="bad">Quase. Tente fatorar e cancelar (atenção ao domínio!).</span>';
  }
}
function revealWarm(){ $('#warm-sol').style.display='block'; }

// ======== Classify function (rendered) ========
const examples = [
  {tex:'2x+5', type:'Linear'},
  {tex:'x^2-3x+2', type:'Quadrática'},
  {tex:'\\dfrac{x+1}{x-2}', type:'Racional'},
  {tex:'3e^{2x}', type:'Exponencial'},
  {tex:'\\log x', type:'Logarítmica'}
];
let currentCls = {...examples[0]};
function typeset(){ if(window.MathJax){ MathJax.typesetPromise(); } }
function setClassExpr(tex){ $('#cls-render').innerHTML = `\\\\(${tex}\\\\)`; typeset(); }
function newClass(){
  currentCls = examples[randint(0,examples.length-1)];
  setClassExpr(currentCls.tex);
  $('#cls-msg').innerHTML='';
  $('#cls-fn').value='';
}
newClass();
function hintClass(){ $('#cls-msg').innerHTML = '<span class="warn">Dica: polinomial? fração entre polinômios? expoente em x? log?</span>'; }
function checkClass(){
  const pick = $('#cls-fn').value;
  if(!pick){ $('#cls-msg').innerHTML = '<span class="bad">Escolha um tipo.</span>'; return; }
  if(pick===currentCls.type){ $('#cls-msg').innerHTML = '<span class="ok">Correto!</span>'; markDone('a2'); }
  else { $('#cls-msg').innerHTML = '<span class="bad">Não. Compare o formato com os exemplos.</span>'; }
}

// ======== Transformations plot ========
function makePlot(canvas, opts){
  const ctx = canvas.getContext('2d');
  const { xmin=-6,xmax=6,ymin=-6,ymax=6 }=opts||{};
  function clear(){ ctx.clearRect(0,0,canvas.width,canvas.height); }
  function toXY(x,y){ const w=canvas.width,h=canvas.height;
    const X=(x-xmin)/(xmax-xmin)*w, Y=h-(y-ymin)/(ymax-ymin)*h; return [X,Y]; }
  function grid(){
    ctx.strokeStyle='#e2e8f0'; ctx.lineWidth=1;
    for(let x=Math.ceil(xmin);x<=xmax;x++){ const [X0,Y0]=toXY(x,ymin),[X1,Y1]=toXY(x,ymax);
      ctx.beginPath(); ctx.moveTo(X0,Y0); ctx.lineTo(X1,Y1); ctx.stroke(); }
    for(let y=Math.ceil(ymin);y<=ymax;y++){ const [X0,Y0]=toXY(xmin,y),[X1,Y1]=toXY(xmax,y);
      ctx.beginPath(); ctx.moveTo(X0,Y0); ctx.lineTo(X1,Y1); ctx.stroke(); }
    ctx.strokeStyle='#94a3b8'; ctx.lineWidth=1.5;
    let [X0,Ya]=toXY(xmin,0),[X1,Yb]=toXY(xmax,0); ctx.beginPath(); ctx.moveTo(X0,Ya); ctx.lineTo(X1,Yb); ctx.stroke();
    let [Xa,Y0a]=toXY(0,ymin),[Xb,Y1a]=toXY(0,ymax); ctx.beginPath(); ctx.moveTo(Xa,Y0a); ctx.lineTo(Xb,Y1a); ctx.stroke();
  }
  function plot(fn, color='#0b1220'){
    ctx.strokeStyle=color; ctx.lineWidth=2; ctx.beginPath();
    let f=true; for(let x=xmin;x<=xmax;x+=0.02){ const y=fn(x); const [X,Y]=toXY(x,y);
      if(f){ ctx.moveTo(X,Y); f=false; } else { ctx.lineTo(X,Y); } }
    ctx.stroke();
  }
  return {clear,grid,plot,toXY,opts:{xmin,xmax,ymin,ymax}};
}
(function(){
  const c = document.getElementById('plot-tr');
  function autoresizeCanvas(c){
    const dpr=window.devicePixelRatio||1, rect=c.getBoundingClientRect();
    c.width=Math.floor(rect.width*dpr); c.height=Math.floor(rect.height*dpr);
    c.getContext('2d').setTransform(dpr,0,0,dpr,0,0);
  }
  function redraw(){
    autoresizeCanvas(c);
    const plt = makePlot(c,{xmin:-6,xmax:6,ymin:-6,ymax:6});
    const h=parseFloat($('#tr-h').value), k=parseFloat($('#tr-k').value), a=parseFloat($('#tr-a').value);
    plt.clear(); plt.grid();
    plt.plot(x=>x*x,'#64748b'); // base x^2
    plt.plot(x=>a*(x-h)*(x-h)+k,'#0b1220'); // transformed
    $('#tr-info').innerHTML = `g(x) = ${a.toFixed(2)}·(x ${h>=0?'-':'+'} ${Math.abs(h).toFixed(2)})² ${k>=0?'+':'−'} ${Math.abs(k).toFixed(2)}`;
  }
  for(const id of ['tr-h','tr-k','tr-a']) document.getElementById(id).addEventListener('input', redraw);
  window.addEventListener('resize', redraw);
  redraw();
})();

// ======== Guided Exercises ========
let ex1Hints = 0;
function hintEx1(){
  ex1Hints++;
  const out = $('#ex1-msg');
  if(ex1Hints===1) out.innerHTML='<span class="warn">Dica 1: multiplique pelos denominadores.</span>';
  else if(ex1Hints===2) out.innerHTML='<span class="warn">Dica 2: 2x+3 = 5(x−1).</span>';
  else out.innerHTML='<span class="warn">Dica 3: isole x.</span>';
}
function checkEx1(){
  const v = parseFloat($('#ex1').value);
  if(Number.isNaN(v)){ $('#ex1-msg').innerHTML='<span class="bad">Digite um valor.</span>'; return; }
  if(Math.abs(v - (8/3)) < 1e-9){ $('#ex1-msg').innerHTML='<span class="ok">Correto!</span>'; $('#ex1-sol').style.display='none'; markDone('a4'); }
  else { $('#ex1-msg').innerHTML='<span class="bad">Ainda não. Tente aplicar as dicas.</span>'; }
}
function solEx1(){ $('#ex1-sol').style.display='block'; }

let ex2Hints = 0;
function hintEx2(){
  ex2Hints++;
  const out = $('#ex2-msg');
  if(ex2Hints===1) out.innerHTML='<span class="warn">Dica 1: g(0)=A+C.</span>';
  else if(ex2Hints===2) out.innerHTML='<span class="warn">Dica 2: g(1)=Ae^{k}+C.</span>';
  else out.innerHTML='<span class="warn">Dica 3: subtraia as equações.</span>';
}
function checkEx2(){
  const A = parseFloat($('#ex2A').value), k = parseFloat($('#ex2k').value), C = parseFloat($('#ex2C').value);
  if([A,k,C].some(Number.isNaN)){ $('#ex2-msg').innerHTML='<span class="bad">Preencha A, k e C.</span>'; return; }
  const ok1 = Math.abs(A + C - 7) < 1e-3;
  const ok2 = Math.abs(A * Math.exp(k) + C - (Math.exp(2) + 3)) < 1e-3;
  if(ok1 && ok2){ $('#ex2-msg').innerHTML='<span class="ok">Conjunto válido ✔</span>'; $('#ex2-sol').style.display='none'; markDone('a4'); }
  else { $('#ex2-msg').innerHTML='<span class="bad">Não bate. Revise as equações.</span>'; }
}
function solEx2(){ $('#ex2-sol').style.display='block'; }

// ======== Mini-prova ========
let QUIZ = [];
function qLinear(){
  const a=randint(-6,6)||2; const x=randint(-6,6); const b=randint(-8,8); const c=a*x+b;
  return {type:'lin', text:`Resolva: ${a}x ${b>=0?'+':''}${b} = ${c}`, answer:x, sol:`${a}x = ${c-b} ⇒ x = ${(c-b)}/${a} = ${x}`};
}
function qQuad(){
  const r1=randint(-5,5), r2=randint(-5,5), a=1, b=-(r1+r2), c=r1*r2;
  return {type:'quad', text:`Raízes de: x² ${b>=0?'+':''}${b}x ${c>=0?'+':''}${c} = 0`, answer:[Math.min(r1,r2),Math.max(r1,r2)], sol:`Δ=${b*b-4*c}. Raízes: ${Math.min(r1,r2)} e ${Math.max(r1,r2)}.`};
}
function qClass(){
  const ex = examples[randint(0,examples.length-1)];
  return {type:'cls', text:`Classifique: ${ex.type==='Racional'?'(x+1)/(x-2)':(ex.type==='Exponencial'?'3e^{2x}':(ex.type==='Logarítmica'?'log x':(ex.type==='Quadrática'?'x^2-3x+2':'2x+5')))} `,
          answer:ex.type, sol:`Tipo correto: ${ex.type}.`};
}
function newQuiz(){
  QUIZ = [qLinear(), qQuad(), qClass()];
  const html = QUIZ.map((q,i)=>{
    if(q.type==='lin'){
      return `<div style="margin-bottom:10px"><b>Q${i+1}.</b> ${q.text}
        <div class="grid-2" style="margin-top:6px"><label>x = <input type="number" id="q${i}"></label></div>
        <details id="s${i}" style="display:none"><summary>Solução</summary><div>${q.sol}</div></details>
      </div>`;
    } else if(q.type==='quad'){
      return `<div style="margin-bottom:10px"><b>Q${i+1}.</b> ${q.text}
        <div class="grid-3" style="margin-top:6px">
          <label>raiz 1 (menor) <input type="number" id="q${i}a"></label>
          <label>raiz 2 (maior) <input type="number" id="q${i}b"></label>
          <span class="tip">Dica: soma = −b, produto = c</span>
        </div>
        <details id="s${i}" style="display:none"><summary>Solução</summary><div>${q.sol}</div></details>
      </div>`;
    } else {
      return `<div style="margin-bottom:10px"><b>Q${i+1}.</b> ${q.text}
        <div class="grid-2" style="margin-top:6px">
          <select id="q${i}">
            <option value=\"\">Escolher…</option>
            <option>Linear</option><option>Quadrática</option><option>Racional</option><option>Exponencial</option><option>Logarítmica</option>
          </select>
        </div>
        <details id="s${i}" style="display:none"><summary>Solução</summary><div>${q.sol}</div></details>
      </div>`;
    }
  }).join('');
  $('#quiz').innerHTML = html;
  $('#quiz-msg').innerHTML='';
  if(window.MathJax){ MathJax.typesetPromise(); }
}
newQuiz();
function checkQuiz(){
  let correct=0;
  QUIZ.forEach((q,i)=>{
    if(q.type==='lin'){
      const v=parseFloat($('#q'+i).value);
      if(!Number.isNaN(v) && Math.abs(v-q.answer)<1e-9){ correct++; $('#s'+i).style.display='none'; }
      else { $('#s'+i).style.display='block'; }
    } else if(q.type==='quad'){
      const a=parseFloat($('#q'+i+'a').value), b=parseFloat($('#q'+i+'b').value);
      if(!Number.isNaN(a)&&!Number.isNaN(b)){
        const R=[Math.min(a,b),Math.max(a,b)];
        if(Math.abs(R[0]-q.answer[0])<1e-9 && Math.abs(R[1]-q.answer[1])<1e-9){ correct++; $('#s'+i).style.display='none'; }
        else { $('#s'+i).style.display='block'; }
      } else { $('#s'+i).style.display='block'; }
    } else if(q.type==='cls'){
      const pick = $('#q'+i).value;
      if(pick===q.answer){ correct++; $('#s'+i).style.display='none'; } else { $('#s'+i).style.display='block'; }
    }
  });
  $('#quiz-msg').innerHTML = `<span class="${correct===QUIZ.length?'ok':(correct>=2?'warn':'bad')}">Acertos: ${correct}/${QUIZ.length}.</span>`;
}
</script>
</body>
</html>
