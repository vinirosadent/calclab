<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>CalcLab • Módulo 1 — Álgebra & Funções (Tutor)</title>
<meta name="description" content="Curso interativo do zero ao cálculo. Módulo 1 cobre Álgebra aplicada e Funções, com explicações, exercícios, dicas e soluções.">
<style>
  :root {
    --bg:#f8fafc; --panel:#fff; --ink:#0f172a; --muted:#475569; --border:#e2e8f0; --accent:#4f46e5;
    --ok:#065f46; --bad:#9f1239; --warn:#854d0e;
  }
  *{box-sizing:border-box}
  body{margin:0;font-family:system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial;color:var(--ink);background:var(--bg)}
  header{position:sticky;top:0;background:#ffffffcc;backdrop-filter:blur(8px);border-bottom:1px solid var(--border)}
  .wrap{max-width:1200px;margin:0 auto;padding:12px 16px;display:flex;gap:12px;align-items:center}
  h1{font-size:18px;margin:0}
  .tag{font-size:11px;background:#e0e7ff;color:#3730a3;border-radius:999px;padding:3px 8px}
  main{max-width:1200px;margin:0 auto;padding:20px 16px 40px;display:grid;grid-template-columns:320px 1fr;gap:20px}
  .card{background:var(--panel);border:1px solid var(--border);border-radius:16px;box-shadow:0 1px 2px rgba(0,0,0,.03)}
  .sidebar{padding:16px}
  .sidebar h2{margin:0 0 8px;font-size:16px}
  .nav li{display:flex;justify-content:space-between;align-items:center;padding:8px 0;border-bottom:1px dashed var(--border);font-size:14px}
  .nav li:last-child{border-bottom:none}
  .pill{font-size:12px;border-radius:999px;padding:2px 8px}
  .done{background:#d1fae5;color:var(--ok)} .todo{background:#e2e8f0;color:#334155}
  .content{display:grid;gap:16px}
  .section{padding:16px}
  .section h3{margin:0 0 8px;font-size:18px}
  .row{display:grid;grid-template-columns:1fr 1fr;gap:16px}
  .panel{background:#f1f5f9;border:1px solid var(--border);border-radius:12px;padding:10px}
  .muted{color:var(--muted)} .ok{color:var(--ok)} .bad{color:var(--bad)} .warn{color:var(--warn)}
  .btn{border:1px solid var(--border);background:white;color:#111827;border-radius:10px;padding:8px 12px;cursor:pointer}
  .btn.primary{background:var(--accent);border-color:var(--accent);color:white}
  .btn.flat{background:#eef2ff;border-color:#c7d2fe}
  .btn:disabled{opacity:.6;cursor:not-allowed}
  .grid-2{display:grid;grid-template-columns:1fr 1fr;gap:10px}
  .grid-3{display:grid;grid-template-columns:1fr 1fr 1fr;gap:10px}
  .kv{display:flex;justify-content:space-between;font-size:13px;margin:4px 0;color:var(--muted)}
  input[type="number"], input[type="text"]{width:100%;padding:8px;border:1px solid var(--border);border-radius:8px}
  input[type="range"], select, textarea{width:100%}
  textarea{min-height:90px}
  canvas{width:100%;height:320px;border-radius:10px;background:white;border:1px solid var(--border)}
  details{border:1px dashed var(--border);padding:8px;border-radius:8px;background:#fbfdff}
  summary{cursor:pointer}
  hr{border:none;border-top:1px dashed var(--border);margin:16px 0}
  .tutor{position:sticky; top:80px; display:flex; gap:10px; align-items:flex-start; background:#fff; border:1px solid var(--border); border-radius:12px; padding:10px}
  .tutor .avatar{width:36px;height:36px;border-radius:50%;background:#e0e7ff;display:flex;align-items:center;justify-content:center;font-weight:700;color:#3730a3}
  .tutor .msg{font-size:14px; color:#0f172a}
  .tip{font-size:12px;color:#334155;background:#f8fafc;border:1px solid var(--border);padding:6px 8px;border-radius:8px}
  .badge{font-size:11px;border-radius:6px;padding:2px 6px;background:#ecfeff;color:#0369a1;border:1px solid #bae6fd}
  @media (max-width: 980px){ main{grid-template-columns:1fr} .row{grid-template-columns:1fr} .tutor{position:relative; top:0} }
</style>
</head>
<body>
  <header>
    <div class="wrap">
      <h1>CalcLab • Do Zero ao Cálculo</h1>
      <div class="tag">Módulo 1 — Álgebra & Funções (modo tutor)</div>
    </div>
  </header>

  <main>
    <aside class="sidebar card">
      <h2>Sua trilha</h2>
      <ul class="nav">
        <li><span>1. Álgebra aplicada</span><span id="p-a1" class="pill todo">Pendente</span></li>
        <li><span>2. Funções: visão geral</span><span id="p-a2" class="pill todo">Pendente</span></li>
        <li><span>3. Transformações de gráficos</span><span id="p-a3" class="pill todo">Pendente</span></li>
        <li><span>4. Exercícios guiados</span><span id="p-a4" class="pill todo">Pendente</span></li>
        <li><span>5. Mini-prova</span><span id="p-a5" class="pill todo">Pendente</span></li>
      </ul>
      <div class="tutor">
        <div class="avatar">T</div>
        <div class="msg">
          <b>Seu Tutor</b><br>
          “Eu guio passo a passo. Errou? Eu dou <u>dicas graduais</u> antes de revelar a solução.”
        </div>
      </div>
      <p class="muted" style="margin-top:8px">Progresso salvo automaticamente no navegador.</p>
    </aside>

    <section class="content">

      <!-- 1. ALGEBRA APLICADA -->
      <div class="card section">
        <h3>1) Álgebra aplicada — o que é e por que importa</h3>
        <div class="row">
          <div class="panel">
            <p><b>Álgebra</b> é a linguagem simbólica para descrever relações entre quantidades. Você manipula variáveis e expressões para <i>generalizar</i> padrões e resolver problemas.</p>
            <p>Exemplos de uso imediato:</p>
            <ul>
              <li><b>Modelos de crescimento</b> (exponencial/logístico): prever populações, reações químicas.</li>
              <li><b>Economia/finanças</b>: juros compostos \(A(t)=A_0(1+i)^t\), taxas efetivas.</li>
              <li><b>Física</b>: movimento \(s(t)=s_0+v_0 t + \\tfrac{1}{2}at^2\).</li>
            </ul>
            <details><summary>Produtos notáveis & fatoração (referência rápida)</summary>
              <ul>
                <li>\((a+b)^2=a^2+2ab+b^2\), \((a-b)^2=a^2-2ab+b^2\)</li>
                <li>\(a^2-b^2=(a-b)(a+b)\)</li>
                <li>Fator comum: \(ax+ay=a(x+y)\)</li>
              </ul>
            </details>
          </div>
          <div>
            <div class="panel">
              <h4>Exercício de aquecimento</h4>
              <p>Simplifique a expressão racional (assuma \(x\\ne\\pm 3\)):</p>
              <div class="grid-2">
                <div><b>\\( \\dfrac{x^2-9}{x^2-6x+9} \\)</b></div>
                <div><input id="warm1" type="text" placeholder="Digite a forma fatorada/simplificada"></div>
              </div>
              <div class="grid-3" style="margin-top:8px">
                <button class="btn" onclick="hintWarm()">Dica</button>
                <button class="btn primary" onclick="checkWarm()">Verificar</button>
                <button class="btn" onclick="revealWarm()">Ver solução</button>
              </div>
              <div id="warm-msg" class="kv"></div>
              <details id="warm-sol" style="display:none;margin-top:8px"><summary>Solução completa</summary>
                <div>\(x^2-9=(x-3)(x+3)\); \(x^2-6x+9=(x-3)^2\). Logo, \(
                  \\dfrac{(x-3)(x+3)}{(x-3)^2} = \\dfrac{x+3}{x-3}\\).</div>
              </details>
            </div>
            <div style="margin-top:12px">
              <button class="btn flat" onclick="markDone('a1')">Marcar seção concluída</button>
            </div>
          </div>
        </div>
      </div>

      <!-- 2. FUNÇÕES OVERVIEW -->
      <div class="card section">
        <h3>2) Funções — visão geral e classificação</h3>
        <div class="row">
          <div class="panel">
            <p>Uma função associa a cada entrada \(x\) exatamente uma saída \(y=f(x)\). Principais tipos que usamos antes do cálculo:</p>
            <ul>
              <li><b>Linear</b>: \(f(x)=ax+b\) — reta; \(a\) é inclinação, \(b\) é intercepto.</li>
              <li><b>Quadrática</b>: \(f(x)=ax^2+bx+c\) — parábola; vértice em \(x=-\\tfrac{b}{2a}\).</li>
              <li><b>Racional</b>: \(f(x)=\\frac{p(x)}{q(x)}\), com assimptotas quando \(q(x)=0\).</li>
              <li><b>Exponencial</b>: \(f(x)=A\\cdot b^x\\) (ou \(A e^{kx}\)) — crescimento/decadência.</li>
              <li><b>Logarítmica</b>: inversa da exponencial; \(\\log_b x\).</li>
            </ul>
            <p class="tip">Chave para o cálculo: entender como os parâmetros alteram forma e crescimento.</p>
          </div>
          <div>
            <div class="panel">
              <h4>Classifique a função</h4>
              <div class="grid-2">
                <select id="cls-fn">
                  <option value="">Escolha o tipo</option>
                  <option>Linear</option><option>Quadrática</option><option>Racional</option><option>Exponencial</option><option>Logarítmica</option>
                </select>
                <input id="cls-expr" type="text" placeholder="Ex.: 2x+3 ou (x+1)/(x-2)">
              </div>
              <div class="grid-3" style="margin-top:8px">
                <button class="btn" onclick="hintClass()">Dica</button>
                <button class="btn primary" onclick="checkClass()">Verificar</button>
                <button class="btn" onclick="newClass()">Novo exemplo</button>
              </div>
              <div id="cls-msg" class="kv"></div>
            </div>
            <div style="margin-top:12px">
              <button class="btn flat" onclick="markDone('a2')">Marcar seção concluída</button>
            </div>
          </div>
        </div>
      </div>

      <!-- 3. TRANSFORMAÇÕES DE GRÁFICOS -->
      <div class="card section">
        <h3>3) Transformações de gráficos</h3>
        <p>Veja como \(y=f(x)\) muda com <span class="badge">translações</span>, <span class="badge">escala</span> e <span class="badge">reflexões</span>.</p>
        <div class="row">
          <div class="panel">
            <h4>Base: parábola \(f(x)=x^2\)</h4>
            <canvas id="plot-tr"></canvas>
          </div>
          <div>
            <div class="grid-2">
              <label>Translação horizontal (h) <input id="tr-h" type="range" min="-4" max="4" value="0" step="0.1"></label>
              <label>Translação vertical (k) <input id="tr-k" type="range" min="-5" max="5" value="0" step="0.1"></label>
              <label>Escala vertical (a) <input id="tr-a" type="range" min="-3" max="3" value="1" step="0.1"></label>
            </div>
            <div id="tr-info" class="kv"></div>
            <details style="margin-top:8px"><summary>Resumo</summary>
              <ul>
                <li>\(y=f(x-h)\) move o gráfico para a direita em \(h\).</li>
                <li>\(y=f(x)+k\) sobe/abaixa \(k\).</li>
                <li>\(y=a\\cdot f(x)\) estica/achata; se \(a&lt;0\), reflete.</li>
              </ul>
            </details>
            <div style="margin-top:12px">
              <button class="btn flat" onclick="markDone('a3')">Marcar seção concluída</button>
            </div>
          </div>
        </div>
      </div>

      <!-- 4. EXERCÍCIOS GUIADOS -->
      <div class="card section">
        <h3>4) Exercícios guiados (com dicas graduais)</h3>
        <div class="row">
          <div class="panel">
            <h4>4.1 Resolver equação racional</h4>
            <p>Resolva para \(x\): \\( \\dfrac{2x+3}{x-1} = 5 \\)</p>
            <div class="grid-2">
              <input id="ex1" type="number" placeholder="x = ?">
              <div class="grid-3">
                <button class="btn" onclick="hintEx1()">Dica</button>
                <button class="btn primary" onclick="checkEx1()">Verificar</button>
                <button class="btn" onclick="solEx1()">Ver solução</button>
              </div>
            </div>
            <div id="ex1-msg" class="kv"></div>
            <details id="ex1-sol" style="display:none;margin-top:8px"><summary>Solução</summary>
              <div>Multiplique ambos os lados por \(x-1\): \(2x+3=5(x-1)\) ⇒ \(2x+3=5x-5\) ⇒ \(-3x=-8\) ⇒ \(x=\\tfrac{8}{3}\). Verificar domínio: \(x\\ne 1\). ✓</div>
            </details>
          </div>
          <div class="panel">
            <h4>4.2 Identificar parâmetros</h4>
            <p>Dada \(g(x)=A\\cdot e^{kx}+C\), se \(g(0)=7\) e \(g(1)=e^2+3\), então:</p>
            <div class="grid-3">
              <label>A = <input id="ex2A" type="number" step="0.01"></label>
              <label>k = <input id="ex2k" type="number" step="0.01"></label>
              <label>C = <input id="ex2C" type="number" step="0.01"></label>
            </div>
            <div class="grid-3" style="margin-top:8px">
              <button class="btn" onclick="hintEx2()">Dica</button>
              <button class="btn primary" onclick="checkEx2()">Verificar</button>
              <button class="btn" onclick="solEx2()">Ver solução</button>
            </div>
            <div id="ex2-msg" class="kv"></div>
            <details id="ex2-sol" style="display:none;margin-top:8px"><summary>Solução</summary>
              <div>\(g(0)=A\\cdot e^{0}+C=A+C=7\). Também \(g(1)=A e^{k}+C=e^2+3\). Subtraindo: \(A(e^{k}-1)=e^2-4\).
              Uma escolha natural é \(C=3\) ⇒ \(A=4\) ⇒ \(4(e^{k}-1)=e^2-4\) ⇒ \(e^{k}=e^2/4\) ⇒ \(k=\\ln(e^2/4)=2-\\ln 4\).</div>
            </details>
          </div>
        </div>
      </div>

      <!-- 5. MINI-PROVA -->
      <div class="card section">
        <h3>5) Mini-prova (auto-correção + soluções)</h3>
        <div id="quiz" class="panel"></div>
        <div class="grid-2" style="margin-top:8px">
          <button class="btn" onclick="newQuiz()">Gerar questões</button>
          <button class="btn primary" onclick="checkQuiz()">Corrigir</button>
        </div>
        <div id="quiz-msg" class="kv"></div>
        <div style="margin-top:12px"><button class="btn flat" onclick="markDone('a5')">Marcar seção concluída</button></div>
      </div>

    </section>
  </main>

<script>
// ======= Utils & Progress =======
const $ = (s)=>document.querySelector(s);
function save(k,v){ localStorage.setItem(k, JSON.stringify(v)); }
function load(k,d){ try{ const v = JSON.parse(localStorage.getItem(k)); return v ?? d; }catch{ return d; } }
function randint(a,b){ return Math.floor(Math.random()*(b-a+1))+a; }

const prog = load('clab-m1-tutor',{a1:false,a2:false,a3:false,a4:false,a5:false});
function updatePills(){
  for(const k of ['a1','a2','a3','a4','a5']){
    const pill = $('#p-'+k);
    const done = !!prog[k];
    pill.className = 'pill '+(done?'done':'todo');
    pill.textContent = done?'Concluído':'Pendente';
  }
}
function markDone(k){ prog[k]=true; save('clab-m1-tutor',prog); updatePills(); }
updatePills();

// ======== Warm-up (rational simplification) ========
let warmHints = 0;
function hintWarm(){
  warmHints++;
  const out = $('#warm-msg');
  if(warmHints===1) out.innerHTML = '<span class="warn">Dica 1: fatorize numerador e denominador.</span>';
  else if(warmHints===2) out.innerHTML = '<span class="warn">Dica 2: x²−9=(x−3)(x+3) e x²−6x+9=(x−3)².</span>';
  else out.innerHTML = '<span class="warn">Agora tente cancelar fatores comuns (x≠±3).</span>';
}
function checkWarm(){
  const v = ($('#warm1').value||'').replace(/\s+/g,'');
  if(v === '(x+3)/(x-3)' || v === '(x+3)/(x-3)'.replace(/\s+/g,'')){
    $('#warm-msg').innerHTML = '<span class="ok">Perfeito! ✔</span>'; $('#warm-sol').style.display='none';
  } else {
    $('#warm-msg').innerHTML = '<span class="bad">Quase. Tente fatorar e cancelar (atenção: domínio!).</span>';
  }
}
function revealWarm(){ $('#warm-sol').style.display='block'; }

// ======== Classify function ========
const examples = [
  {expr:'2x+5', type:'Linear'},
  {expr:'x^2-3x+2', type:'Quadrática'},
  {expr:'(x+1)/(x-2)', type:'Racional'},
  {expr:'3*e^(2x)', type:'Exponencial'},
  {expr:'log(x)', type:'Logarítmica'}
];
let currentCls = {...examples[0]};
function newClass(){
  currentCls = examples[randint(0,examples.length-1)];
  $('#cls-expr').value = currentCls.expr;
  $('#cls-msg').innerHTML='';
}
newClass();
function hintClass(){ $('#cls-msg').innerHTML = '<span class="warn">Dica: olhe o formato — polinomial? fração? exponencial em x? log?</span>'; }
function checkClass(){
  const pick = $('#cls-fn').value;
  if(!pick){ $('#cls-msg').innerHTML = '<span class="bad">Escolha um tipo.</span>'; return; }
  if(pick===currentCls.type){ $('#cls-msg').innerHTML = '<span class="ok">Correto!</span>'; markDone('a2'); }
  else { $('#cls-msg').innerHTML = '<span class="bad">Não. Compare com os formatos da lista.</span>'; }
}

// ======== Transformations plot ========
function makePlot(canvas, opts){
  const ctx = canvas.getContext('2d');
  const { xmin=-6,xmax=6,ymin=-6,ymax=6 }=opts||{};
  function clear(){ ctx.clearRect(0,0,canvas.width,canvas.height); }
  function toXY(x,y){ const w=canvas.width,h=canvas.height;
    const X=(x-xmin)/(xmax-xmin)*w, Y=h-(y-ymin)/(ymax-ymin)*h; return [X,Y]; }
  function grid(){
    ctx.strokeStyle='#cbd5e1'; ctx.lineWidth=1;
    for(let x=Math.ceil(xmin);x<=xmax;x++){ const [X0,Y0]=toXY(x,ymin),[X1,Y1]=toXY(x,ymax);
      ctx.beginPath(); ctx.moveTo(X0,Y0); ctx.lineTo(X1,Y1); ctx.stroke(); }
    for(let y=Math.ceil(ymin);y<=ymax;y++){ const [X0,Y0]=toXY(xmin,y),[X1,Y1]=toXY(xmax,y);
      ctx.beginPath(); ctx.moveTo(X0,Y0); ctx.lineTo(X1,Y1); ctx.stroke(); }
    ctx.strokeStyle='#94a3b8'; ctx.lineWidth=1.5;
    let [X0,Ya]=toXY(xmin,0),[X1,Yb]=toXY(xmax,0); ctx.beginPath(); ctx.moveTo(X0,Ya); ctx.lineTo(X1,Yb); ctx.stroke();
    let [Xa,Y0a]=toXY(0,ymin),[Xb,Y1a]=toXY(0,ymax); ctx.beginPath(); ctx.moveTo(Xa,Y0a); ctx.lineTo(Xb,Y1a); ctx.stroke();
  }
  function plot(fn, color='#111827'){
    ctx.strokeStyle=color; ctx.lineWidth=2; ctx.beginPath();
    let f=true; for(let x=xmin;x<=xmax;x+=0.02){ const y=fn(x); const [X,Y]=toXY(x,y);
      if(f){ ctx.moveTo(X,Y); f=false; } else { ctx.lineTo(X,Y); } }
    ctx.stroke();
  }
  return {clear,grid,plot,toXY,opts:{xmin,xmax,ymin,ymax}};
}
(function(){
  const c = document.getElementById('plot-tr');
  function autoresizeCanvas(c){
    const dpr=window.devicePixelRatio||1, rect=c.getBoundingClientRect();
    c.width=Math.floor(rect.width*dpr); c.height=Math.floor(rect.height*dpr);
    c.getContext('2d').setTransform(dpr,0,0,dpr,0,0);
  }
  function redraw(){
    autoresizeCanvas(c);
    const plt = makePlot(c,{xmin:-6,xmax:6,ymin:-6,ymax:6});
    const h=parseFloat($('#tr-h').value), k=parseFloat($('#tr-k').value), a=parseFloat($('#tr-a').value);
    plt.clear(); plt.grid();
    // base and transformed
    plt.plot(x=>x*x,'#64748b'); // base x^2
    plt.plot(x=>a*(x-h)*(x-h)+k,'#111827'); // transformed
    $('#tr-info').innerHTML = `f(x) = (x)<sup>2</sup> → g(x) = ${a.toFixed(2)}·(x ${h>=0?'-':'+'} ${Math.abs(h).toFixed(2)})² ${k>=0?'+':'−'} ${Math.abs(k).toFixed(2)}`;
  }
  for(const id of ['tr-h','tr-k','tr-a']) document.getElementById(id).addEventListener('input', redraw);
  window.addEventListener('resize', redraw);
  redraw();
})();

// ======== Guided Exercises ========
// Ex 1
let ex1Hints = 0;
function hintEx1(){
  ex1Hints++;
  const out = $('#ex1-msg');
  if(ex1Hints===1) out.innerHTML='<span class="warn">Dica 1: multiplique pelos denominadores.</span>';
  else if(ex1Hints===2) out.innerHTML='<span class="warn">Dica 2: 2x+3 = 5(x−1).</span>';
  else out.innerHTML='<span class="warn">Dica 3: isole x.</span>';
}
function checkEx1(){
  const v = parseFloat($('#ex1').value);
  if(Number.isNaN(v)){ $('#ex1-msg').innerHTML='<span class="bad">Digite um valor.</span>'; return; }
  if(Math.abs(v - (8/3)) < 1e-9){ $('#ex1-msg').innerHTML='<span class="ok">Correto!</span>'; $('#ex1-sol').style.display='none'; markDone('a4'); }
  else { $('#ex1-msg').innerHTML='<span class="bad">Ainda não. Tente aplicar as dicas.</span>'; }
}
function solEx1(){ $('#ex1-sol').style.display='block'; }

// Ex 2 (parameters of exponential)
let ex2Hints = 0;
function hintEx2(){
  ex2Hints++;
  const out = $('#ex2-msg');
  if(ex2Hints===1) out.innerHTML='<span class="warn">Dica 1: g(0)=A+C.</span>';
  else if(ex2Hints===2) out.innerHTML='<span class="warn">Dica 2: g(1)=Ae^{k}+C.</span>';
  else out.innerHTML='<span class="warn">Dica 3: subtraia as equações para eliminar C.</span>';
}
function checkEx2(){
  const A = parseFloat($('#ex2A').value), k = parseFloat($('#ex2k').value), C = parseFloat($('#ex2C').value);
  if([A,k,C].some(Number.isNaN)){ $('#ex2-msg').innerHTML='<span class="bad">Preencha A, k e C.</span>'; return; }
  // we accept values satisfying A+C=7 and A*e^k + C = e^2 + 3
  const ok1 = Math.abs(A + C - 7) < 1e-3;
  const ok2 = Math.abs(A * Math.exp(k) + C - (Math.exp(2) + 3)) < 1e-3;
  if(ok1 && ok2){ $('#ex2-msg').innerHTML='<span class="ok">Conjunto válido ✔</span>'; $('#ex2-sol').style.display='none'; markDone('a4'); }
  else { $('#ex2-msg').innerHTML='<span class="bad">Não bate. Revise as duas equações.</span>'; }
}
function solEx2(){ $('#ex2-sol').style.display='block'; }

// ======== Mini-prova ========
let QUIZ = [];
function qLinear(){
  const a=randint(-6,6)||2; const x=randint(-6,6); const b=randint(-8,8); const c=a*x+b;
  return {type:'lin', text:`Resolva: ${a}x ${b>=0?'+':''}${b} = ${c}`, answer:x, sol:`${a}x = ${c-b} ⇒ x = ${(c-b)}/${a} = ${x}`};
}
function qQuad(){
  const r1=randint(-5,5), r2=randint(-5,5), a=1, b=-(r1+r2), c=r1*r2;
  return {type:'quad', text:`Raízes de: x² ${b>=0?'+':''}${b}x ${c>=0?'+':''}${c} = 0`, answer:[Math.min(r1,r2),Math.max(r1,r2)], sol:`Δ=${b*b-4*c}. Raízes: ${Math.min(r1,r2)} e ${Math.max(r1,r2)}.`};
}
function qClass(){
  const ex = examples[randint(0,examples.length-1)];
  return {type:'cls', text:`Classifique: ${ex.expr}`, answer:ex.type, sol:`Tipo correto: ${ex.type}.`};
}
function newQuiz(){
  QUIZ = [qLinear(), qQuad(), qClass()];
  const html = QUIZ.map((q,i)=>{
    if(q.type==='lin'){
      return `<div style="margin-bottom:10px"><b>Q${i+1}.</b> ${q.text}
        <div class="grid-2" style="margin-top:6px"><label>x = <input type="number" id="q${i}"></label></div>
        <details id="s${i}" style="display:none"><summary>Solução</summary><div>${q.sol}</div></details>
      </div>`;
    } else if(q.type==='quad'){
      return `<div style="margin-bottom:10px"><b>Q${i+1}.</b> ${q.text}
        <div class="grid-3" style="margin-top:6px">
          <label>raiz 1 (menor) <input type="number" id="q${i}a"></label>
          <label>raiz 2 (maior) <input type="number" id="q${i}b"></label>
          <span class="tip">Dica: soma = −b, produto = c</span>
        </div>
        <details id="s${i}" style="display:none"><summary>Solução</summary><div>${q.sol}</div></details>
      </div>`;
    } else {
      return `<div style="margin-bottom:10px"><b>Q${i+1}.</b> ${q.text}
        <div class="grid-2" style="margin-top:6px">
          <select id="q${i}">
            <option value=\"\">Escolher…</option>
            <option>Linear</option><option>Quadrática</option><option>Racional</option><option>Exponencial</option><option>Logarítmica</option>
          </select>
        </div>
        <details id="s${i}" style="display:none"><summary>Solução</summary><div>${q.sol}</div></details>
      </div>`;
    }
  }).join('');
  $('#quiz').innerHTML = html;
  $('#quiz-msg').innerHTML='';
}
newQuiz();
function checkQuiz(){
  let correct=0;
  QUIZ.forEach((q,i)=>{
    if(q.type==='lin'){
      const v=parseFloat($('#q'+i).value);
      if(!Number.isNaN(v) && Math.abs(v-q.answer)<1e-9){ correct++; $('#s'+i).style.display='none'; }
      else { $('#s'+i).style.display='block'; }
    } else if(q.type==='quad'){
      const a=parseFloat($('#q'+i+'a').value), b=parseFloat($('#q'+i+'b').value);
      if(!Number.isNaN(a)&&!Number.isNaN(b)){
        const R=[Math.min(a,b),Math.max(a,b)];
        if(Math.abs(R[0]-q.answer[0])<1e-9 && Math.abs(R[1]-q.answer[1])<1e-9){ correct++; $('#s'+i).style.display='none'; }
        else { $('#s'+i).style.display='block'; }
      } else { $('#s'+i).style.display='block'; }
    } else if(q.type==='cls'){
      const pick = $('#q'+i).value;
      if(pick===q.answer){ correct++; $('#s'+i).style.display='none'; } else { $('#s'+i).style.display='block'; }
    }
  });
  $('#quiz-msg').innerHTML = `<span class="${correct===QUIZ.length?'ok':(correct>=2?'warn':'bad')}">Acertos: ${correct}/${QUIZ.length}.</span>`;
}
</script>
</body>
</html>
